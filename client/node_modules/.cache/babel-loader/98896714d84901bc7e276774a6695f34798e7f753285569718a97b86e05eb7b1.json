{"ast":null,"code":"import axios from'axios';const API_BASE_URL=process.env.REACT_APP_API_URL||'/api';// Create axios instance\nconst api=axios.create({baseURL:API_BASE_URL,headers:{'Content-Type':'application/json'}});// Request interceptor to add auth token\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;});// Response interceptor for error handling\napi.interceptors.response.use(response=>response,error=>{var _error$response;// Don't auto-redirect on 401, let components handle it\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){console.log('API: 401 error received');// Only clear storage, don't redirect\nlocalStorage.removeItem('token');localStorage.removeItem('user');}return Promise.reject(error);});// Auth API\nexport const authAPI={login:data=>api.post('/auth/login',data),register:data=>api.post('/auth/register',data),getMe:()=>api.get('/auth/me'),updateProfile:data=>api.put('/users/me',data),changePassword:data=>api.put('/auth/change-password',data)};// Trips API\nexport const tripsAPI={getTrips:params=>api.get('/trips/',{params}),// Add trailing slash\ngetTrip:id=>api.get(\"/trips/\".concat(id)),getTripById:id=>api.get(\"/trips/\".concat(id)),createTrip:data=>api.post('/trips/',data),// Add trailing slash\nupdateTrip:(id,data)=>api.put(\"/trips/\".concat(id),data),deleteTrip:id=>api.delete(\"/trips/\".concat(id)),addToWishlist:(id,place)=>api.post(\"/trips/\".concat(id,\"/wishlist\"),{place}),updateItinerary:(id,itinerary)=>api.put(\"/trips/\".concat(id,\"/itinerary\"),{itinerary}),updatePackingList:(id,packingList)=>api.put(\"/trips/\".concat(id,\"/packing\"),{packingList}),generateShareLink:id=>api.post(\"/trips/\".concat(id,\"/share\")),getSharedTrip:token=>api.get(\"/trips/shared/\".concat(token))};// Expenses API\nexport const expensesAPI={getExpenses:(tripId,params)=>api.get(\"/expenses/trip/\".concat(tripId),{params}),createExpense:data=>api.post('/expenses',data),updateExpense:(id,data)=>api.put(\"/expenses/\".concat(id),data),deleteExpense:id=>api.delete(\"/expenses/\".concat(id)),getExpenseStats:tripId=>api.get(\"/expenses/stats/\".concat(tripId))};// Journals API\nexport const journalsAPI={getJournals:(tripId,params)=>api.get(\"/journals/trip/\".concat(tripId),{params}),getJournal:id=>api.get(\"/journals/\".concat(id)),createJournal:data=>api.post('/journals',data),updateJournal:(id,data)=>api.put(\"/journals/\".concat(id),data),deleteJournal:id=>api.delete(\"/journals/\".concat(id)),autoGenerateJournal:(tripId,date)=>api.post(\"/journals/\".concat(tripId,\"/auto-generate/\").concat(date)),generateTravelogue:tripId=>api.post(\"/journals/trip/\".concat(tripId,\"/generate-travelogue\"))};// Users API\nexport const usersAPI={searchUsers:query=>api.get('/users/search',{params:{q:query}})};// File upload utility\nexport const uploadFile=async function(file){let folder=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'general';const formData=new FormData();formData.append('file',file);formData.append('folder',folder);const response=await api.post('/upload',formData,{headers:{'Content-Type':'multipart/form-data'}});return response.data.url;};export default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","concat","response","error","_error$response","status","console","log","removeItem","Promise","reject","authAPI","login","data","post","register","getMe","get","updateProfile","put","changePassword","tripsAPI","getTrips","params","getTrip","id","getTripById","createTrip","updateTrip","deleteTrip","delete","addToWishlist","place","updateItinerary","itinerary","updatePackingList","packingList","generateShareLink","getSharedTrip","expensesAPI","getExpenses","tripId","createExpense","updateExpense","deleteExpense","getExpenseStats","journalsAPI","getJournals","getJournal","createJournal","updateJournal","deleteJournal","autoGenerateJournal","date","generateTravelogue","usersAPI","searchUsers","query","q","uploadFile","file","folder","arguments","length","undefined","formData","FormData","append","url"],"sources":["/Users/jeanlee/travel-diary-app/client/src/services/api.ts"],"sourcesContent":["import axios, { AxiosResponse } from 'axios';\nimport { \n  User, Trip, Expense, JournalEntry, ExpenseStats, Travelogue,\n  LoginForm, RegisterForm, TripForm, ExpenseForm, JournalForm,\n  PaginatedResponse\n} from '../types';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use((config) => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// Response interceptor for error handling\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    // Don't auto-redirect on 401, let components handle it\n    if (error.response?.status === 401) {\n      console.log('API: 401 error received');\n      // Only clear storage, don't redirect\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n    }\n    return Promise.reject(error);\n  }\n);\n\n// Auth API\nexport const authAPI = {\n  login: (data: LoginForm): Promise<AxiosResponse<{ token: string; user: User; message: string }>> =>\n    api.post('/auth/login', data),\n  \n  register: (data: RegisterForm): Promise<AxiosResponse<{ token: string; user: User; message: string }>> =>\n    api.post('/auth/register', data),\n  \n  getMe: (): Promise<AxiosResponse<User>> =>\n    api.get('/auth/me'),\n  \n  updateProfile: (data: Partial<User>): Promise<AxiosResponse<{ user: User; message: string }>> =>\n    api.put('/users/me', data),\n  \n  changePassword: (data: { currentPassword: string; newPassword: string }): Promise<AxiosResponse<{ message: string }>> =>\n    api.put('/auth/change-password', data),\n};\n\n// Trips API\nexport const tripsAPI = {\n  getTrips: (params?: { status?: string; page?: number; limit?: number }): Promise<AxiosResponse<Trip[]>> =>\n    api.get('/trips/', { params }), // Add trailing slash\n  \n  getTrip: (id: string): Promise<AxiosResponse<{ trip: Trip; message: string }>> =>\n    api.get(`/trips/${id}`),\n  \n  getTripById: (id: string): Promise<AxiosResponse<{ trip: Trip; message: string }>> =>\n    api.get(`/trips/${id}`),\n  \n  createTrip: (data: TripForm): Promise<AxiosResponse<{ trip: Trip; message: string }>> =>\n    api.post('/trips/', data), // Add trailing slash\n  \n  updateTrip: (id: string, data: Partial<Trip>): Promise<AxiosResponse<{ trip: Trip; message: string }>> =>\n    api.put(`/trips/${id}`, data),\n  \n  deleteTrip: (id: string): Promise<AxiosResponse<{ message: string }>> =>\n    api.delete(`/trips/${id}`),\n  \n  addToWishlist: (id: string, place: any): Promise<AxiosResponse<{ wishlist: any[]; message: string }>> =>\n    api.post(`/trips/${id}/wishlist`, { place }),\n  \n  updateItinerary: (id: string, itinerary: any[]): Promise<AxiosResponse<{ itinerary: any[]; message: string }>> =>\n    api.put(`/trips/${id}/itinerary`, { itinerary }),\n  \n  updatePackingList: (id: string, packingList: any[]): Promise<AxiosResponse<{ packingList: any[]; message: string }>> =>\n    api.put(`/trips/${id}/packing`, { packingList }),\n  \n  generateShareLink: (id: string): Promise<AxiosResponse<{ shareUrl: string }>> =>\n    api.post(`/trips/${id}/share`),\n  \n  getSharedTrip: (token: string): Promise<AxiosResponse<{ trip: Trip }>> =>\n    api.get(`/trips/shared/${token}`),\n};\n\n// Expenses API\nexport const expensesAPI = {\n  getExpenses: (tripId: string, params?: { category?: string; startDate?: string; endDate?: string; page?: number; limit?: number }): Promise<AxiosResponse<PaginatedResponse<Expense> & { categoryTotals: any[]; totalSpent: number; currency: string }>> =>\n    api.get(`/expenses/trip/${tripId}`, { params }),\n  \n  createExpense: (data: ExpenseForm & { trip: string }): Promise<AxiosResponse<{ expense: Expense }>> =>\n    api.post('/expenses', data),\n  \n  updateExpense: (id: string, data: Partial<ExpenseForm>): Promise<AxiosResponse<{ expense: Expense }>> =>\n    api.put(`/expenses/${id}`, data),\n  \n  deleteExpense: (id: string): Promise<AxiosResponse<{ message: string }>> =>\n    api.delete(`/expenses/${id}`),\n  \n  getExpenseStats: (tripId: string): Promise<AxiosResponse<ExpenseStats>> =>\n    api.get(`/expenses/stats/${tripId}`),\n};\n\n// Journals API\nexport const journalsAPI = {\n  getJournals: (tripId: string, params?: { page?: number; limit?: number }): Promise<AxiosResponse<PaginatedResponse<JournalEntry>>> =>\n    api.get(`/journals/trip/${tripId}`, { params }),\n  \n  getJournal: (id: string): Promise<AxiosResponse<{ journal: JournalEntry }>> =>\n    api.get(`/journals/${id}`),\n  \n  createJournal: (data: JournalForm & { trip: string }): Promise<AxiosResponse<{ journal: JournalEntry }>> =>\n    api.post('/journals', data),\n  \n  updateJournal: (id: string, data: Partial<JournalForm>): Promise<AxiosResponse<{ journal: JournalEntry }>> =>\n    api.put(`/journals/${id}`, data),\n  \n  deleteJournal: (id: string): Promise<AxiosResponse<{ message: string }>> =>\n    api.delete(`/journals/${id}`),\n  \n  autoGenerateJournal: (tripId: string, date: string): Promise<AxiosResponse<{ journal: JournalEntry }>> =>\n    api.post(`/journals/${tripId}/auto-generate/${date}`),\n  \n  generateTravelogue: (tripId: string): Promise<AxiosResponse<{ travelogue: Travelogue }>> =>\n    api.post(`/journals/trip/${tripId}/generate-travelogue`),\n};\n\n// Users API\nexport const usersAPI = {\n  searchUsers: (query: string): Promise<AxiosResponse<{ users: User[] }>> =>\n    api.get('/users/search', { params: { q: query } }),\n};\n\n// File upload utility\nexport const uploadFile = async (file: File, folder: string = 'general'): Promise<string> => {\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('folder', folder);\n  \n  const response = await api.post('/upload', formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data',\n    },\n  });\n  \n  return response.data.url;\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}