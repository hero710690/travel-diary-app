{"ast":null,"code":"import React,{useState}from'react';import{useDrop}from'react-dnd';import{format}from'date-fns';import DraggableItineraryItem from'./DraggableItineraryItem';import FlightCard from'./FlightCard';import FlightForm from'./FlightForm';import{PaperAirplaneIcon}from'@heroicons/react/24/outline';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const ItineraryDay=_ref=>{let{day,items,onDrop,onRemoveItem,onUpdateItem,onMoveItem,onAddFlight}=_ref;const[showFlightForm,setShowFlightForm]=useState(false);const[editingFlight,setEditingFlight]=useState(null);const[{isOver},drop]=useDrop(()=>({accept:['place','itinerary-item'],drop:item=>{if('place_id'in item){// It's a place from wishlist\nonDrop(item);}else if('id'in item&&onMoveItem){// It's an itinerary item being moved between days\nonMoveItem(item.id,day.dayNumber);}},collect:monitor=>({isOver:monitor.isOver()})}));const sortedItems=items.sort((a,b)=>a.time.localeCompare(b.time));const handleAddFlight=flightInfo=>{if(onAddFlight){// Use departure time as the default time for the itinerary item\nconst time=flightInfo.departure.time;onAddFlight(day.dayNumber,flightInfo,time);}setShowFlightForm(false);};const handleEditFlight=item=>{setEditingFlight(item);setShowFlightForm(true);};const handleUpdateFlight=flightInfo=>{if(editingFlight&&onUpdateItem){onUpdateItem(editingFlight.id,{flightInfo,time:flightInfo.departure.time,title:\"\".concat(flightInfo.airline,\" \").concat(flightInfo.flightNumber),description:\"\".concat(flightInfo.departure.airportCode,\" \\u2192 \").concat(flightInfo.arrival.airportCode)});}setEditingFlight(null);setShowFlightForm(false);};const handleCancelFlightForm=()=>{setShowFlightForm(false);setEditingFlight(null);};return/*#__PURE__*/_jsxs(\"div\",{ref:drop,className:\"border-2 border-dashed rounded-lg p-4 transition-colors \".concat(isOver?'border-blue-400 bg-blue-50':'border-gray-200 hover:border-gray-300'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium text-gray-900\",children:[\"Day \",day.dayNumber]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:format(day.date,'EEEE, MMM d')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400\",children:[items.length,\" \",items.length===1?'activity':'activities']}),onAddFlight&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFlightForm(true),className:\"inline-flex items-center px-2 py-1 text-xs font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500\",title:\"Add Flight\",children:[/*#__PURE__*/_jsx(PaperAirplaneIcon,{className:\"h-3 w-3 mr-1\"}),\"Flight\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:sortedItems.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-2\",children:isOver?'Drop here to add to this day':'Drag places here to plan your day'}),onAddFlight&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFlightForm(true),className:\"inline-flex items-center px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(PaperAirplaneIcon,{className:\"h-4 w-4 mr-2\"}),\"Add Flight Information\"]})]}):sortedItems.map(item=>item.type==='flight'&&item.flightInfo?/*#__PURE__*/_jsx(FlightCard,{flightInfo:item.flightInfo,time:item.time,onEdit:()=>handleEditFlight(item),onDelete:()=>onRemoveItem(item.id)},item.id):/*#__PURE__*/_jsx(DraggableItineraryItem,{item:item,onRemove:onRemoveItem,onUpdate:onUpdateItem},item.id))}),isOver&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\",children:[\"Drop to add to Day \",day.dayNumber]})}),showFlightForm&&/*#__PURE__*/_jsx(FlightForm,{initialData:editingFlight===null||editingFlight===void 0?void 0:editingFlight.flightInfo,onSave:editingFlight?handleUpdateFlight:handleAddFlight,onCancel:handleCancelFlightForm})]});};export default ItineraryDay;","map":{"version":3,"names":["React","useState","useDrop","format","DraggableItineraryItem","FlightCard","FlightForm","PaperAirplaneIcon","jsxs","_jsxs","jsx","_jsx","ItineraryDay","_ref","day","items","onDrop","onRemoveItem","onUpdateItem","onMoveItem","onAddFlight","showFlightForm","setShowFlightForm","editingFlight","setEditingFlight","isOver","drop","accept","item","id","dayNumber","collect","monitor","sortedItems","sort","a","b","time","localeCompare","handleAddFlight","flightInfo","departure","handleEditFlight","handleUpdateFlight","title","concat","airline","flightNumber","description","airportCode","arrival","handleCancelFlightForm","ref","className","children","date","length","onClick","map","type","onEdit","onDelete","onRemove","onUpdate","initialData","onSave","onCancel"],"sources":["/Users/jeanlee/travel-diary-app/client/src/components/ItineraryDay.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useDrop } from 'react-dnd';\nimport { format } from 'date-fns';\nimport { ItineraryItem, FlightInfo } from '../types';\nimport DraggableItineraryItem from './DraggableItineraryItem';\nimport FlightCard from './FlightCard';\nimport FlightForm from './FlightForm';\nimport { \n  PlusIcon, \n  PaperAirplaneIcon \n} from '@heroicons/react/24/outline';\n\ninterface Place {\n  place_id: string;\n  name: string;\n  formatted_address: string;\n}\n\ninterface Day {\n  date: Date;\n  dayNumber: number;\n}\n\ninterface ItineraryDayProps {\n  day: Day;\n  items: ItineraryItem[];\n  onDrop: (place: Place) => void;\n  onRemoveItem: (itemId: string) => void;\n  onUpdateItem?: (itemId: string, updates: Partial<ItineraryItem>) => void;\n  onMoveItem?: (itemId: string, newDay: number) => void;\n  onAddFlight?: (dayNumber: number, flightInfo: FlightInfo, time: string) => void;\n}\n\nconst ItineraryDay: React.FC<ItineraryDayProps> = ({ \n  day, \n  items, \n  onDrop, \n  onRemoveItem,\n  onUpdateItem,\n  onMoveItem,\n  onAddFlight\n}) => {\n  const [showFlightForm, setShowFlightForm] = useState(false);\n  const [editingFlight, setEditingFlight] = useState<ItineraryItem | null>(null);\n\n  const [{ isOver }, drop] = useDrop(() => ({\n    accept: ['place', 'itinerary-item'],\n    drop: (item: Place | ItineraryItem) => {\n      if ('place_id' in item) {\n        // It's a place from wishlist\n        onDrop(item);\n      } else if ('id' in item && onMoveItem) {\n        // It's an itinerary item being moved between days\n        onMoveItem(item.id, day.dayNumber);\n      }\n    },\n    collect: (monitor) => ({\n      isOver: monitor.isOver(),\n    }),\n  }));\n\n  const sortedItems = items.sort((a, b) => a.time.localeCompare(b.time));\n\n  const handleAddFlight = (flightInfo: FlightInfo) => {\n    if (onAddFlight) {\n      // Use departure time as the default time for the itinerary item\n      const time = flightInfo.departure.time;\n      onAddFlight(day.dayNumber, flightInfo, time);\n    }\n    setShowFlightForm(false);\n  };\n\n  const handleEditFlight = (item: ItineraryItem) => {\n    setEditingFlight(item);\n    setShowFlightForm(true);\n  };\n\n  const handleUpdateFlight = (flightInfo: FlightInfo) => {\n    if (editingFlight && onUpdateItem) {\n      onUpdateItem(editingFlight.id, {\n        flightInfo,\n        time: flightInfo.departure.time,\n        title: `${flightInfo.airline} ${flightInfo.flightNumber}`,\n        description: `${flightInfo.departure.airportCode} â†’ ${flightInfo.arrival.airportCode}`,\n      });\n    }\n    setEditingFlight(null);\n    setShowFlightForm(false);\n  };\n\n  const handleCancelFlightForm = () => {\n    setShowFlightForm(false);\n    setEditingFlight(null);\n  };\n\n  return (\n    <div\n      ref={drop}\n      className={`border-2 border-dashed rounded-lg p-4 transition-colors ${\n        isOver \n          ? 'border-blue-400 bg-blue-50' \n          : 'border-gray-200 hover:border-gray-300'\n      }`}\n    >\n      <div className=\"flex items-center justify-between mb-3\">\n        <div>\n          <h3 className=\"font-medium text-gray-900\">\n            Day {day.dayNumber}\n          </h3>\n          <p className=\"text-sm text-gray-500\">\n            {format(day.date, 'EEEE, MMM d')}\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <div className=\"text-xs text-gray-400\">\n            {items.length} {items.length === 1 ? 'activity' : 'activities'}\n          </div>\n          {onAddFlight && (\n            <button\n              onClick={() => setShowFlightForm(true)}\n              className=\"inline-flex items-center px-2 py-1 text-xs font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              title=\"Add Flight\"\n            >\n              <PaperAirplaneIcon className=\"h-3 w-3 mr-1\" />\n              Flight\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        {sortedItems.length === 0 ? (\n          <div className=\"text-center py-6\">\n            <p className=\"text-sm text-gray-500 mb-2\">\n              {isOver ? 'Drop here to add to this day' : 'Drag places here to plan your day'}\n            </p>\n            {onAddFlight && (\n              <button\n                onClick={() => setShowFlightForm(true)}\n                className=\"inline-flex items-center px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <PaperAirplaneIcon className=\"h-4 w-4 mr-2\" />\n                Add Flight Information\n              </button>\n            )}\n          </div>\n        ) : (\n          sortedItems.map((item) => (\n            item.type === 'flight' && item.flightInfo ? (\n              <FlightCard\n                key={item.id}\n                flightInfo={item.flightInfo}\n                time={item.time}\n                onEdit={() => handleEditFlight(item)}\n                onDelete={() => onRemoveItem(item.id)}\n              />\n            ) : (\n              <DraggableItineraryItem\n                key={item.id}\n                item={item}\n                onRemove={onRemoveItem}\n                onUpdate={onUpdateItem}\n              />\n            )\n          ))\n        )}\n      </div>\n\n      {isOver && (\n        <div className=\"mt-2 text-center\">\n          <div className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n            Drop to add to Day {day.dayNumber}\n          </div>\n        </div>\n      )}\n\n      {/* Flight Form Modal */}\n      {showFlightForm && (\n        <FlightForm\n          initialData={editingFlight?.flightInfo}\n          onSave={editingFlight ? handleUpdateFlight : handleAddFlight}\n          onCancel={handleCancelFlightForm}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ItineraryDay;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}